# Dockerfile for InfiniLM-SVC
# Multi-service system for distributed LLM serving

FROM python:3.11-slim

# Set working directory
WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    curl \
    bash \
    && rm -rf /var/lib/apt/lists/*

# Copy requirements and install Python dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application files
COPY . .

# Make scripts executable
RUN chmod +x *.sh

# Create logs directory
RUN mkdir -p logs

# Expose common ports
# Note: Actual ports depend on configuration in launch scripts
EXPOSE 8000 8080 8081 8100 8101 8200 8201

# Use docker_entrypoint.sh as entrypoint
# Note: Using shell form to ensure bash is available for scripts
ENTRYPOINT ["/bin/bash", "/app/docker_entrypoint.sh"]

# Usage:
# Build: docker build -t infinilm-svc:latest .
# Run: docker run -d --name infinilm-svc -p 8000:8000 -p 8080:8080 -p 8081:8081 infinilm-svc:latest
# Stop: docker stop infinilm-svc
# Logs: docker logs -f infinilm-svc
